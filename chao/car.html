<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>chaohongji</title>
<link href="css/public.css" rel="stylesheet" type="text/css">
<link href="css/style.css" rel="stylesheet" type="text/css">

        
    
</head>
	<body>
		<div id="header">
	<div class="margin">
		<span class="huan">欢迎光临潮宏基商城！</span>
		<!--<a href="">登陆</a><s>|</s><a href="">免费注册</a>-->
		 <h2 class="not-login"><a href="register.html">注册</a>&nbsp;<a href="login.html">登录</a></h2>
		<img src="images/weibo.png" class="t1" />
		<img src="images/qq.png" class="t2" />
		<img src="images/dun.png"  class="t3"/>
		<img src="images/tel.png"  class="t4"/> 
		<a  class="shop" href="car.html">
			
			<img src="images/suo.png" class="suo" />
			<span href="car.html">购物袋 0 件</span>
			<img src="images/dao.png" class="dao"/> 
		
		</a>
		<i>我的账户<img src="images/daosan.png"/></i>
		<i>网站导航<img src="images/daosan.png"/></i>
		<i>帮助中心</i>
		
	</div>
</div>
<div id="logo">
	<div class="margin">
		<img src="images/logo.png" />
	</div>
	<form>
		<input type="text" class="txt" placeholder="请输入搜索关键字"/>
		<input type="submit" class="sub" value="搜索"/>
		<p>热搜： 戒指 耳饰 吊坠 哆啦A梦 情侣对戒</p>
	</form>
	<div class="qq">
        	<div class="s"><span>在线客服</span><img src="images/cha.png" class="off"/></div>
        	<p>QQ客服</p>
        	<div><img src="http://pub.idqqimg.com/qconn/wpa/button/button_old_41.gif" class="qiye"/><a>潮宏基珠</a></div>
        	<div class="bb"><img src="http://pub.idqqimg.com/qconn/wpa/button/button_old_41.gif" class="qiye1"/><b>潮宏基珠</b></div>
        	<div class="aa"><img src="http://pub.idqqimg.com/qconn/wpa/button/button_old_41.gif" class="qiye2"/><s>潮宏基珠</s></div>
        	<div class="cc"><img src="http://pub.idqqimg.com/qconn/wpa/button/button_old_41.gif" class="qiye3"/><i>潮宏基珠</i></div>
        </div>
</div>

<div id="nav">
	<div class="margin">
		<ul class="zz">
			<li class="first1"><a href="index.html">首页</a></li>
			<li>
				<a>戒指</a>
				<div class="a1">
					<div class="left">
						<p>女戒</p>
						<p>对戒</p>
						<p>花戒</p>

					</div>
					<div class="right">
						<h3>热门：</h3>
						<p>戒指</p>
						<h3>品牌：</h3>
						<img src="images/logo.png" />

					</div>
				</div>
			</li>
			<li>
				<a>项饰</a>
				<div class="a2">
					<div class="left">
						<p>项链</p>
						<p>吊坠</p>
						<p>套链</p>

					</div>
					<div class="right">
						<h3>热门：</h3>
						<p>吊坠</p>
						<h3>品牌：</h3>
						<img src="images/logo.png" />

					</div>
				</div>
			</li>
			<li>
				<a>耳饰</a>
				<div class="a3">
					<div class="left">
						<p>耳钉</p>
						<p>耳坠</p>
						

					</div>
					<div class="right">
						<h3>热门：</h3>
						<p>耳饰</p>
						<h3>品牌：</h3>
						<img src="images/logo.png" />

					</div>
			</li>
			<li>
				<a>腕饰</a>
				<div class="a4">
					<div class="left">
						<p>手链</p>
						<p>手镯</p>
						

					</div>
					<div class="right">
						<h3>热门：</h3>
						<p>耳饰</p>
						<h3>品牌：</h3>
						<img src="images/logo.png" />

					</div>
			</li>
			<li>
				<a>东方文化</a>
				<div class="a5">
					
					
						<h3>热门：</h3>
						<p>戒指 耳饰 吊坠 哆啦A梦 情侣对戒 smiley 熊猫 耳饰</p>
						<h3 class="te">品牌：</h3>
						<img src="images/logo.png" />

				</div>
					
			</li>
			<li>
				<a>新品上市</a>
				<div class="a6">
					
					
						<h3>热门：</h3>
						<p>戒指 耳饰 吊坠 哆啦A梦 情侣对戒 smiley 熊猫 耳饰</p>
						<h3 class="te">品牌：</h3>
						<img src="images/logo.png" />

				</div>
			</li>
			<li><a>企业礼品</a></li>
			<li class="te1"><a>字母链定制</a></li>
			<li class="te1"><a>裸钻定制</a></li>
		</ul>
		<div class="guangbo">
			<img src="images/guangbo.png" />
			<span class="xx">热烈庆祝潮宏基商城上线</span>
		</div>
		
		<div id="register" >
			
			<h2>购物车<small><a href="index.html">继续购物</a></small></h2>
    <table border="1" cellspacing="0" width="800" align="center" class="tab">
        <thead>
            <tr>
                <th>选中</th>
                <th>图片</th>
                <th>名字</th>
                <th>价格</th>
                <th>数量</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            <!-- <tr>
                <td><input type="cheackbox"></td>
                <td><img src="" alt=""></td>
                <td></td>
                <td></td>
                <td></td>
                <td><span>删除</span></td>
            </tr> -->
        </tbody>
    </table>
	
    
  
		</div>
		
		<div id="jieshao">
	<div class="margin">
	<span class="first">公司介绍</span>
	<span>联系我们</span>
	<span>最新动态</span>
	<span>人才招聘</span>
	<span>媒体报道 </span>
	<span>招商加盟</span>
	<span>法律声明</span>
	<span>意见反馈</span>
	<span>网站地图</span>
	</div>
</div>

<div id="footer" class="margin">
	<div class="first">
		<img src="images/r1.png" class="r1"/><span class="r11">100%正品保证</span>
		<img src="images/r2.png" class="r2"/><span class="r22">免费配送全国</span>
		<img src="images/r3.png" class="r3"/><span class="r33">安全支付保障</span>
		<img src="images/r4.png" class="r4"/><span class="r44">7天退换货</span>
	</div>
	<div class="second">
	<p>Copyright © 2008-2013 mychj.com All Rights Reserved 潮宏基官方商城版权所有 </p>
	<p>网站备案号：粤ICP备05096788号-3 技术服务：凡派科技 </p>
	</div>
	<div class="last">
		<img src="images/kk1.png" class="a" />
		<img src="images/kk2.png" class="b"  />
		<img src="images/kk3.png" class="c" />
		<img src="images/kk4.png" class="d"  />
		<img src="images/kk5.png" class="e"  />
	</div>
	<div class="dibu"><img src="images/top.png"</div>
	
</div>



	</body>
<script src="jquery.2.2.4.js"></script>
<script src="libs/jquery.validate.js"></script>
<script src="libs/jquery.validate.messages_zh.js"></script>
<script src="ajax.2.0.js"></script>
<script src="cookie.js"></script>
<script>
	

	
	

	
	
	
	
	$(function(){
			$(".zz").children("li").mouseover(function(){
				$(this).children("div").stop().show().parent().siblings().children("div").stop().hide()
				$(this).css("background","#600e0e")
			})
			$(".zz").children("li").mouseout(function(){
				$(this).children("div").stop().hide()
				$(this).css("background","#9a2438")
			})
			$(".first1").mouseout(function(){
				
				$(this).css("background","#600e0e")
			})
			$(".te1").mouseover(function(){
				
				$(this).children("a").css("color","darkred")
				$(this).css("background","#464646")
			})
			$(".te1").mouseout(function(){
				
				$(this).children("a").css("color","white")
				$(this).css("background","#464646")
			})
			
	
		})//二级子菜单
	
	$(".dibu").click(function(){
        
        $("html").animate({
            scrollTop:$("#header").offset().top
        })
      })
	
	$(".off").click( function(){
		$(".qq").hide()
		
	})//右侧关闭QQ
	
function time(){ 
$(".xx").slideToggle(1000)
}setInterval("time()",2000);//广播淡出淡入


class Car{
        constructor(){
            this.tbody = document.querySelector("tbody");
            this.url = "http://localhost/1903/xxx/data/list.json";

            // 请求所有数据
            this.init();
            // D1.绑定span的点击事件
            this.addEvent()
        }
        init(){
            var that = this;
            ajax({
                url:this.url,
                success:function(res){
                    that.res = JSON.parse(res)
                    // 拿到cookie
                    that.getCookie()
                }
            })
        }
        getCookie(){
            // console.log(this.res)
            this.goods = JSON.parse(getCookie("shangpin"));
            // 渲染页面
            this.display();
        }
        display(){
            // console.log(this.res)
            // console.log(this.goods)
            var str = "";
            // 遍历所有数据
            for(var i=0;i<this.res.length;i++){
                // 遍历所有cookie
                for(var j=0;j<this.goods.length;j++){
                    // 两相对比，发现id重复，那就是要加入购物车的商品
                    if(this.res[i].goodsId == this.goods[j].id){
                        str += `<tr index="${this.goods[j].id}">
                                    <td><input type="checkbox"></td>
                                    <td><img src="${this.res[i].src}"></td>
                                    <td>${this.res[i].name}</td>
                                    <td>${this.res[i].price}</td>
                                    <td><input type="number" value="${this.goods[j].num}" min=1></td>
                                    <td><span class="delete">删除</span></td>
                                </tr>`
                    }
                }
            }
            this.tbody.innerHTML = str;
        }
        addEvent(){
            var that = this;
            // 利用事件委托绑定span的事件
            this.tbody.addEventListener("click",function(eve){
                if(eve.target.className == "delete"){
                    // D2.保存商品id
                    that.id = eve.target.parentNode.parentNode.getAttribute("index");
                    // D3.删除DOM元素
                    eve.target.parentNode.parentNode.remove()
                    // D4.删除cookie中的数据
                    that.changeCookie(function(i){
                        that.goods.splice(i,1)
                    })
                }
            })
            this.tbody.addEventListener("input",function(eve){
                if(eve.target.type == "number"){
                    // U1.保存商品id
                    that.id = eve.target.parentNode.parentNode.getAttribute("index");
                    // 保存输入框的值
                    // that.num = eve.target.value;
                    // U2.修改cookie中的数据
                    that.changeCookie(function(i){
                        that.goods[i].num = eve.target.value;
                    })
                }
            })
        }
        changeCookie(callback){
            for(var i=0;i<this.goods.length;i++){
                if(this.goods[i].id == this.id){
                    // 删除或修改
                    callback(i)
                    break;
                }
            }
            setCookie("shangpin",JSON.stringify(this.goods))
        }
        // removeCookie(){
        //     // 遍历cookie，找到符合点击的商品的数据
        //     for(var i=0;i<this.goods.length;i++){
        //         if(this.goods[i].id == this.id){
        //             // 从数组中将符合条件的数据，剔除出去
        //             this.goods.splice(i,1);
        //             break;
        //         }
        //     }
        //     // D5.把剔除了数据之后的数组，再塞回去
        //     setCookie("shangpin",JSON.stringify(this.goods))
        // }
        // setCookie(){
        //     // 遍历cookie，找到符合点击的商品的数据
        //     for(var i=0;i<this.goods.length;i++){
        //         if(this.goods[i].id == this.id){
        //             // 从数组中将符合条件的数据，修改
        //             this.goods[i].num = this.num;
        //             break;
        //         }
        //     }
        //     // U3.把剔除了数据之后的数组，再塞回去
        //     setCookie("shangpin",JSON.stringify(this.goods))
        // }
    }

    new Car;

</script>
</html>
